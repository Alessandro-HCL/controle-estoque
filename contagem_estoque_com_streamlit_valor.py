import streamlit as st
import pandas as pd
from datetime import datetime
import yagmail
from itens_classificados import itens_classificados

# ğŸ’µ DicionÃ¡rio com valores unitÃ¡rios por item
valores_unitarios = {
    "492 - granola (KG)": 5.00,
    "495 - leite em po (KG)": 1.00,
    "496 - achocolatado (KG)": 1.00,
    "499 - aÃ§ai  (KG)": 1.00,
    "574 - petit gateau (UN)": 1.00,
    "575 - calda de sorvete (KG)": 1.00,
    "597 - biscoito  (CX)": 1.00,
    "602 - bolacha maria / maizena (KG)": 1.00,
    "603 - geleia de frutas vermelhas (KG)": 1.00,
    "651 - cobertura chocolate (KG)": 1.00,
    "652 - cobertura morango (KG)": 1.00,
    "745 - mini cheesecake (CX)": 1.00,
    "335 - ovos  (UN)": 1.00,
    "336 - salvia (KG)": 1.00,
    "337 - manjericao (KG)": 1.00,
    "338 - manjericao (KG)": 1.00,
    "339 - tomilho (KG)": 1.00,
    "340 - louro (KG)": 1.00,
    "341 - hortela (UN)": 1.00,
    "342 - cenoura (KG)": 1.00,
    "343 - beterraba (UN)": 1.00,
    "344 - berinjela (KG)": 1.00,
    "454 - pimenta paprica doce (KG)": 1.00,
    "455 - pimenta paprica defumada (KG)": 1.00,
    "456 - pimenta paprica picante (KG)": 1.00,
    "461 - pimenta calabresa (KG)": 1.00,
    "509 - AIOLI (KG)": 1.00,
    "512 - salsinha verde (KG)": 1.00,
    "520 - carne moida (KG)": 1.00,
    "524 - peixe file (vilmar) (KG)": 1.00,
    "569 - oleo algodao  balde (UN)": 1.00,
    "697 - ovos de codorna (UN)": 1.00,
    "781 - abacate (KG)": 1.00,
    "824 - peixe inteiro (vilmar) (KG)": 1.00,
    "285 - presunto fatiado  (KG)": 1.00,
    "286 - peito peru (KG)": 1.00,
    "287 - copa (KG)": 1.00,
    "288 - salame (KG)": 1.00,
    "289 - presunto parma (KG)": 1.00,
    "294 - pao mini ciabata (KG)": 1.00,
    "295 - pao ciabata (KG)": 1.00,
    "297 - pao baguete 250g (KG)": 1.00,
    "302 - linguiÃ§a toscana frango (KG)": 1.00,
    "359 - carne de siri  (KG)": 1.00,
    "361 - marisco (KG)": 1.00,
    "362 - ostra (UN)": 1.00,
    "364 - camarao rosa (KG)": 1.00,
    "365 - camarao cinza (KG)": 1.00,
    "366 - lula (KG)": 1.00,
    "474 - salgadinho doritos (KG)": 1.00,
    "476 - lombo canadense (KG)": 1.00,
    "481 - pao italiano (KG)": 1.00,
    "482 - milho (KG)": 1.00,
    "484 - pao de queijo (KG)": 1.00,
    "493 - fermento quimico (KG)": 1.00,
    "494 - fermento biologico seco (KG)": 1.00,
    "505 - geleia de pimenta (KG)": 1.00,
    "513 - cebolinha verde (KG)": 1.00,
    "514 - papel alumiun (UN)": 1.00,
    "521 - batata frita  (KG)": 1.00,
    "534 - requeijao catupiry  (KG)": 1.00,
    "622 - pao australiano (KG)": 1.00,
    "623 - linguiÃ§a calabresa (KG)": 1.00,
    "624 - linguiÃ§a paio (KG)": 1.00,
    "690 - pao portugues (KG)": 1.00,
    "691 - pao fazenda (KG)": 1.00,
    "692 - pao de queijo com parmesao (KG)": 1.00,
    "693 - massa folhada (UN)": 1.00,
    "725 - ostra (UN)": 1.00,
    "779 - pao baguete 100g (KG)": 1.00,
    "780 - pao baguete 125g (KG)": 1.00,
    "783 - cafe soluvel (KG)": 1.00,
    "786 - pao de queijo doce (KG)": 1.00,
    "787 - pao de queijo rech catupiry (KG)": 1.00,
    "817 - linguiÃ§a toscana  (KG)": 1.00,
    "822 - camarao argentino (KG)": 1.00,
    "868 - camarao vennamei  VG (KG)": 1.00,
    "870 - pao mini couvert (KG)": 1.00,
    "933 - papel toalha (UN)": 1.00,
    "317 - cebola branca (KG)": 1.00,
    "318 - cebola roxa (KG)": 1.00,
    "319 - alho  (KG)": 1.00,
    "320 - alho poro (UN)": 1.00,
    "321 - tomate salada (KG)": 1.00,
    "322 - tomate cereja (KG)": 1.00,
    "323 - tomate molho (KG)": 1.00,
    "325 - pimentao amarelo (KG)": 1.00,
    "326 - pimentao verde (KG)": 1.00,
    "327 - pimentao vermelho (KG)": 1.00,
    "328 - rucula (KG)": 1.00,
    "329 - alface americana (KG)": 1.00,
    "330 - alface roxa (KG)": 1.00,
    "331 - acelga (UN)": 1.00,
    "332 - pepino japones  (KG)": 1.00,
    "333 - repolho branco  (KG)": 1.00,
    "334 - repolho roxo (KG)": 1.00,
    "345 - abobrinha (KG)": 1.00,
    "346 - couve-flor (KG)": 1.00,
    "347 - couve manteiga (UN)": 1.00,
    "348 - brocolis  (KG)": 1.00,
    "349 - pimenta dedo de moca (KG)": 1.00,
    "350 - batata salsa baroa (KG)": 1.00,
    "351 - batata asterix (KG)": 1.00,
    "352 - fruta banana da terra (KG)": 1.00,
    "353 - fruta banana caturra (KG)": 1.00,
    "354 - fruta mamao papaia (KG)": 1.00,
    "355 - fruta mamao formosa (KG)": 1.00,
    "356 - fruta melancia (KG)": 1.00,
    "357 - fruta melao (KG)": 1.00,
    "358 - fruta maÃ§a (KG)": 1.00,
    "477 - fruta manga (KG)": 1.00,
    "483 - palmito (KG)": 1.00,
    "485 - champignon (KG)": 1.00,
    "488 - feijao branco (KG)": 1.00,
    "489 - feijao carioca (KG)": 1.00,
    "490 - linhaÃ§a dourada (KG)": 1.00,
    "527 - molho pesto (KG)": 1.00,
    "541 - molho alcaparas e mel  (KG)": 1.00,
    "544 - molho caeser (KG)": 1.00,
    "545 - crotons (KG)": 1.00,
    "619 - agriao (KG)": 1.00,
    "637 - cebola miuda conserva (KG)": 1.00,
    "639 - alecrim  (UN)": 1.00,
    "642 - fruta banana branca (KG)": 1.00,
    "664 - sache vinagre (UN)": 1.00,
    "687 - alface crespa (KG)": 1.00,
    "695 - vagem (KG)": 1.00,
    "775 - feijao fradinho (KG)": 1.00,
    "859 - linhaÃ§a marron (KG)": 1.00,
    "931 - pepino em conserva (KG)": 1.00,
    "272 - manteiga  (KG)": 1.00,
    "273 - creme de leite nata  45% (KG)": 1.00,
    "291 - pao mini sovadinho (KG)": 1.00,
    "292 - pao mini frances (KG)": 1.00,
    "293 - pao fatiado tradicional (UN)": 1.00,
    "480 - pao fatiado integral (UN)": 1.00,
    "530 - molho mostarda iogurte (KG)": 1.00,
    "749 - pao fatiado batata doce (UN)": 1.00,
    "750 - pao fatiado caseiro (UN)": 1.00,
    "8 - Agua s/gas (UN)": 1.00,
    "12 - Agua c/gas (UN)": 1.00,
    "13 - agua tonica lata (UN)": 1.00,
    "15 - agua tonica zero lata (UN)": 1.00,
    "16 - coca cola lata (UN)": 1.00,
    "17 - coca zero lata (UN)": 1.00,
    "18 - fanta laranja lata (UN)": 1.00,
    "19 - guarana lata (UN)": 1.00,
    "20 - guarana zero lata (UN)": 1.00,
    "21 - sprite lata (UN)": 1.00,
    "22 - schweppers citrus lata (UN)": 1.00,
    "26 - energetico red bull lata (UN)": 1.00,
    "27 - energetico red bull tropical lata (UN)": 1.00,
    "192 - coco gelado  (UN)": 1.00,
    "784 - guarana pet (UN)": 1.00,
    "913 - energetico red bull sugar free (UN)": 1.00,
    "153 - picole nestle moca cone (UN)": 1.00,
    "154 - picole nestle prestigio (UN)": 1.00,
    "155 - picole nestle classico ao leite (UN)": 1.00,
    "156 - picole nestle  baton (UN)": 1.00,
    "157 - picole nestle  chambinho morango (UN)": 1.00,
    "158 - picole nestle diamante negro  (UN)": 1.00,
    "159 - picole nestle fine dentadura  (UN)": 1.00,
    "160 - picole nestle fine torcao (UN)": 1.00,
    "161 - picole nestle fine tubes morango  (UN)": 1.00,
    "162 - picole nestle kit kat (UN)": 1.00,
    "163 - picole nestle la fruta coco (UN)": 1.00,
    "164 - picole nestle la fruta limao  (UN)": 1.00,
    "165 - picole nestle la fruta morango (UN)": 1.00,
    "166 - picole nestle la fruta uva (UN)": 1.00,
    "167 - picole nestle  laka (UN)": 1.00,
    "168 - picole nestle  laka oreo  (UN)": 1.00,
    "169 - picole nestle  mega alfajor (UN)": 1.00,
    "170 - picole nestle  mega cheesecake (UN)": 1.00,
    "171 - picole nestle  mega classico (UN)": 1.00,
    "172 - picole nestle  mega tres chocolates (UN)": 1.00,
    "173 - picole nestle moca brigadeiro (UN)": 1.00,
    "174 - picole nestle sonho de valsa (UN)": 1.00,
    "175 - picole nestle oreo  (UN)": 1.00,
    "176 - picole nestle oreo cone  (UN)": 1.00,
    "177 - picole nestle sanduiche oreo (UN)": 1.00,
    "568 - sorvete nestle pote  creme (LT)": 1.00,
    "730 - picole nestle fine tubes tutti  frutti (UN)": 1.00,
    "731 - picole nestle  mega amendoas (UN)": 1.00,
    "732 - picole nestle garoto bombom (UN)": 1.00,
    "733 - picole nestle kitkat (UN)": 1.00,
    "734 - picole nestle cone kitkat (UN)": 1.00,
    "752 - picole nestle mega trufa branco (UN)": 1.00,
    "899 - picole pote oreo bites (UN)": 1.00,
    "909 - picole nestle la fruta maracuja (UN)": 1.00,
    "910 - picole nestle  mega pistache (UN)": 1.00,
    "911 - picole nestle crocante (UN)": 1.00,
    "119 - vinho tinto luigi bosca cabernet sauviginon (UN)": 1.00,
    "120 - vinho tinto terranoble carmenere (UN)": 1.00,
    "121 - vinho tinto claude val paul mas  (UN)": 1.00,
    "122 - vinho tinto intis cabernet sauviginon (UN)": 1.00,
    "123 - vinho tinto la linda malbec (UN)": 1.00,
    "124 - vinho tinto marques de montemor quinta da pansel (UN)": 1.00,
    "125 - vinho tinto olapo melot los lirios (UN)": 1.00,
    "126 - vinho tinto rey de copas tempranillo (UN)": 1.00,
    "127 - vinho tinto villa cardeto sangiovese (UN)": 1.00,
    "128 - vinho tinto terranoble cabernet sauvignon 375ml (UN)": 1.00,
    "728 - vinho tinto alta yari malbec (UN)": 1.00,
    "729 - vinho tinto sutil reserva carmenere  (UN)": 1.00,
    "821 - vinho tinto intis malbec (UN)": 1.00,
    "890 - vinho tinto uko estate pinot noir (UN)": 1.00,
    "891 - vinho tinto uko estate cabernet sauvignon (UN)": 1.00,
    "892 - vinho tinto mister uko malbec (UN)": 1.00,
    "893 - vinho tinto conclave nocturno cabernet franc (UN)": 1.00,
    "914 - vinho tinto conclave nocturno malbec (UN)": 1.00,
    "107 - vinho branco amalaya torrontes riesling (UN)": 1.00,
    "108 - vinho branco fausto pizzato chardonnay (UN)": 1.00,
    "110 - vinho branco intis sauvignon blanc (UN)": 1.00,
    "111 - vinho branco la linda chardonnay (UN)": 1.00,
    "112 - vinho branco marques de toledo (UN)": 1.00,
    "113 - vinho branco muros antigos  (UN)": 1.00,
    "114 - vinho branco  olapo chardonnay (UN)": 1.00,
    "115 - vinho branco claude val paul mas gewustraminer (UN)": 1.00,
    "116 - vinho branco thera sauvignon blanc (UN)": 1.00,
    "117 - vinho branco vila cardeto pinot grigio (UN)": 1.00,
    "118 - vinho branco terranoble chardonnay 375ml (UN)": 1.00,
    "884 - vinho branco uko estate cherdonnay  (UN)": 1.00,
    "885 - vinho branco uko estate sauvignon blanc (UN)": 1.00,
    "886 - vinho branco uko estate dulce (UN)": 1.00,
    "887 - vinho branco fumata bianca sauvignon (UN)": 1.00,
    "129 - vinho rose claude val  paul mas (UN)": 1.00,
    "130 - vinho rose las moras shyraz (UN)": 1.00,
    "131 - vinho rose thera rose  (UN)": 1.00,
    "888 - vinho uko estate malbec rose (UN)": 1.00,
    "889 - vinho conclave reserva rose (UN)": 1.00,
    "102 - espumante bossa dem sec n2 (UN)": 1.00,
    "103 - espumante bossa moscatel (UN)": 1.00,
    "104 - espumante bossa brut (UN)": 1.00,
    "105 - espumante fausto demi sec (UN)": 1.00,
    "106 - espumante la linda extra brut (UN)": 1.00,
    "894 - espumante cambiado dulce natural (UN)": 1.00,
    "895 - espumante allegra rose extra brut (UN)": 1.00,
    "912 - espumante chandon demi sec (UN)": 1.00,
    "929 - espumante chandon brut (UN)": 1.00,
    "28 - cerveja original 600ml (UN)": 1.00,
    "29 - cerveja heineken long neck (UN)": 1.00,
    "30 - cerveja corona long neck (UN)": 1.00,
    "31 - balde/heineken long neck 10und (UN)": 1.00,
    "32 - balde/corona long neck 10und (UN)": 1.00,
    "33 - cerveja heineken long neck  zero  (UN)": 1.00,
    "773 - chop  schornstein (UN)": 1.00,
    "774 - cerveja heineken 600ml (UN)": 1.00,
    "132 - garrafa aperol (UN)": 1.00,
    "133 - garrafa cachaca  (UN)": 1.00,
    "134 - garrafa whisk jack daniels (UN)": 1.00,
    "135 - garrafa  martine rosso (UN)": 1.00,
    "136 - garrafa  jagermaister (UN)": 1.00,
    "137 - garrafa  gin tanqueray (UN)": 1.00,
    "138 - garrafa tequila ouro  (UN)": 1.00,
    "139 - garrafa tequila prata (UN)": 1.00,
    "140 - garrafa vodka absolut (UN)": 1.00,
    "141 - garrafa vodka smirnoff (UN)": 1.00,
    "142 - garrafa vodka ciroc (UN)": 1.00,
    "143 - garrafa whisk ballantinnes 12 anos (UN)": 1.00,
    "144 - garrafa whisk black label12 anos (UN)": 1.00,
    "145 - garrafa whisk red label (UN)": 1.00,
    "147 - combo smirnoff (UN)": 1.00,
    "149 - garrafa campari  (UN)": 1.00,
    "150 - combo whisk jack daniels (UN)": 1.00,
    "378 - garrafa bacardi carta blanca (UN)": 1.00,
    "385 - garrafa  gin gordons (UN)": 1.00,
    "607 - garrafa amarula (UN)": 1.00,
    "608 -  garrafa licor 43 (UN)": 1.00,
    "720 - garrafa whisk chivas 12 anos (UN)": 1.00,
    "777 - garrafa  gin bombay (UN)": 1.00,
    "778 - garrafa rum montila branca (UN)": 1.00,
    "71 - dose amarula  (UN)": 1.00,
    "73 - dose bacardi (UN)": 1.00,
    "74 - dose campari (UN)": 1.00,
    "75 - dose cachaÃ§a (UN)": 1.00,
    "76 - dose gin tanqueray (UN)": 1.00,
    "77 - dose jack daniels (UN)": 1.00,
    "78 - dose jagermeister (UN)": 1.00,
    "79 - dose licor 43 (UN)": 1.00,
    "80 - dose steinhaeguer  (UN)": 1.00,
    "81 - dose tequila ouro (UN)": 1.00,
    "82 - dose tequila prata (UN)": 1.00,
    "83 - dose vodka absolut (UN)": 1.00,
    "84 - dose vodka ciroc (UN)": 1.00,
    "85 - dose vodka smirnoff (UN)": 1.00,
    "86 - dose whisky 12 anos (UN)": 1.00,
    "87 - dose whisky 8 anos (UN)": 1.00,
    "193 - fruta limao taiti (KG)": 1.00,
    "195 - polpa  morango  (KG)": 1.00,
    "196 - polpa  maracuja (KG)": 1.00,
    "197 - fruta kiwi (KG)": 1.00,
    "198 - polpa abacaxi (KG)": 1.00,
    "199 - fruta laranja  (KG)": 1.00,
    "200 - fruta limao siciliano (KG)": 1.00,
    "201 - anis estrelado  (KG)": 1.00,
    "202 - pimenta zinbro (KG)": 1.00,
    "203 - pimenta rosa (KG)": 1.00,
    "204 - hibisco  (KG)": 1.00,
    "205 - gelo cubo 5 kg (KG)": 1.00,
    "206 - gelo escama (KG)": 1.00,
    "207 - aÃ§ucar refinado (branco) (KG)": 1.00,
    "208 - gengibre (KG)": 1.00,
    "209 - aÃ§ucar organico (KG)": 1.00,
    "210 - clara de ovo pastelrizada (LT)": 1.00,
    "211 - capsula de gas co2 (UN)": 1.00,
    "212 - agua c/gas 1.5 ltros (UN)": 1.00,
    "213 - espumante salton brut (UN)": 1.00,
    "214 - canudo bio  (UN)": 1.00,
    "379 - garrafa cointreau (UN)": 1.00,
    "381 - garrafa steinhaeguer (UN)": 1.00,
    "383 - garrafa sake  (UN)": 1.00,
    "384 - agua tonica 1.5 l (UN)": 1.00,
    "386 -  hisbisco (KG)": 1.00,
    "387 - agua s/gas 20 litros (LT)": 1.00,
    "388 - xarope de gengibre (LT)": 1.00,
    "389 - espuma moscow mule (LT)": 1.00,
    "393 - polpa abacaxi com hortela (KG)": 1.00,
    "398 - xarope de cramberry (UN)": 1.00,
    "399 - xarope de franboesa (UN)": 1.00,
    "400 - xarope de roma (UN)": 1.00,
    "401 - xarope de cha verde (UN)": 1.00,
    "402 - xarope de cha preto (UN)": 1.00,
    "561 - garrfa de martine dry (UN)": 1.00,
    "565 - fruta acerola (KG)": 1.00,
    "566 - polpa mirtilho (KG)": 1.00,
    "567 - canudo mexedor (UN)": 1.00,
    "611 - xarope mix pessego e maracuja (ML)": 1.00,
    "640 -  ovo  pastelrizada (LT)": 1.00,
    "656 - xarope de frutas vermelhas (LT)": 1.00,
    "661 - aÃ§ucar sache (KG)": 1.00,
    "683 - fruta laranja bahia (KG)": 1.00,
    "686 - fruta maracuja   (KG)": 1.00,
    "688 - copo vidro (UN)": 1.00,
    "696 - aÃ§ucar  confeitero (KG)": 1.00,
    "710 - VASILHAME 20 LITROS (LT)": 1.00,
    "715 - suco manguary maracuja (UN)": 1.00,
    "721 - xarope cha verde (UN)": 1.00,
    "722 - xarope cranberry (UN)": 1.00,
    "723 - xarope  framboesa (UN)": 1.00,
    "726 - champanheira branca (UN)": 1.00,
    "727 - saca rolha  (UN)": 1.00,
    "742 - licor creme cassis (UN)": 1.00,
    "790 - polpa amora (KG)": 1.00,
    "830 - emustab (KG)": 1.00,
    "844 - canudo bio mexedor (UN)": 1.00,
    "867 - espumante salton demi sec (UN)": 1.00,
    "920 - xarope maÃ§Ã£ verde (UN)": 1.00,
    "925 - adoÃ§ante sache (KG)": 1.00,
    "926 - adoÃ§ante  (KG)": 1.00,
    "100 - suco del valle uva (UN)": 1.00,
    "101 - suco del valle pessego (UN)": 1.00,
    "826 - saco de lixo  (UN)": 1.00,
    "827 - detergente (UN)": 1.00,
    "828 - agua sanitaria (UN)": 1.00,
    "834 - luva latex (UN)": 1.00,
    "846 - alcool 70% (UN)": 1.00,
    "853 - esfregao (UN)": 1.00,
    "864 - esponja lava louÃ§a (UN)": 1.00,
    "865 - bombril (UN)": 1.00,
    "903 - touca descartavel  (UN)": 1.00,
    "905 - faca descartavel  (UN)": 1.00,
    "906 - colher descartavel (UN)": 1.00,
    "907 - garfo descartavel  (UN)": 1.00,
    "927 - lustra moveis (UN)": 1.00,
    "932 - desincrustante (UN)": 1.00,
    "934 - plastico filme (UN)": 1.00,
    "935 - esponja lava louÃ§a (UN)": 1.00,
    "181 - cigarro marlboro  (UN)": 1.00,
    "182 - cigarro dunhill (UN)": 1.00,
    "274 - queijo parmessao  (KG)": 1.00,
    "277 - queijo gorgonzola (KG)": 1.00,
    "278 - queijo brie (KG)": 1.00,
    "280 - cheddar (KG)": 1.00,
    "281 - cream cheese (KG)": 1.00,
    "283 - creme de leite  (KG)": 1.00,
    "284 - leite (LT)": 1.00,
    "298 -  file mignon (KG)": 1.00,
    "299 - entrecot (KG)": 1.00,
    "300 - coxa sobre coxa de frango (KG)": 1.00,
    "301 - peito de frango (KG)": 1.00,
    "303 - miolo da alcatra (KG)": 1.00,
    "304 - costela bovina  (KG)": 1.00,
    "309 - carne seca (KG)": 1.00,
    "310 - bacon (KG)": 1.00,
    "311 - linguiÃ§a calabresa (KG)": 1.00,
    "312 - linguiÃ§a paio (KG)": 1.00,
    "313 - frango passarinho (KG)": 1.00,
    "314 - picanha suina (KG)": 1.00,
    "316 - costela suina (KG)": 1.00,
    "450 - sal marinho fino  (KG)": 1.00,
    "451 - sal marinho grosso (KG)": 1.00,
    "452 - pimenta do reino (KG)": 1.00,
    "457 - cravo da india  (KG)": 1.00,
    "459 - canela em po (KG)": 1.00,
    "460 - canela em pau (inteira) (KG)": 1.00,
    "466 - aÃ§afrao da terra (KG)": 1.00,
    "467 - hondashi (KG)": 1.00,
    "478 - mandioca aipim (KG)": 1.00,
    "487 - feijao preto (KG)": 1.00,
    "503 - cogumelos paris (KG)": 1.00,
    "504 - cogumelos funghi seco (KG)": 1.00,
    "559 - caldo de galinha (KG)": 1.00,
    "593 - pimenta do reino grao (KG)": 1.00,
    "625 - panceta suina (KG)": 1.00,
    "636 - queijo gouda (KG)": 1.00,
    "655 - paleta musculo bovino (KG)": 1.00,
    "699 - queijo ricota (KG)": 1.00,
    "701 - coxao duro (KG)": 1.00,
    "741 - sal refinado 1g (KG)": 1.00,
    "818 - sal cebola/salsa (KG)": 1.00,
    "908 - peito de frango defumado (KG)": 1.00,
    "275 - queijo provolone (KG)": 1.00,
    "368 - file de peixe linguado (KG)": 1.00,
    "370 - file tilapia (KG)": 1.00,
    "373 - bacalhau (KG)": 1.00,
    "374 - pirarucu (KG)": 1.00,
    "375 - banda tambaqui (KG)": 1.00,
    "376 - costelinha de tambaqui (KG)": 1.00,
    "377 - salmao (KG)": 1.00,
"403 - azeite de dende (ML)": 1.00,
    "404 - azeite de oliva (ML)": 1.00,
    "405 - amido de milho (KG)": 1.00,
    "406 - tomate seco (KG)": 1.00,
    "407 - azeitona preta (KG)": 1.00,
    "408 - azeitona verde (KG)": 1.00,
    "409 - ovo de codorna (KG)": 1.00,
    "410 - vinagre aceto balsamico (ML)": 1.00,
    "411 - shoyo (ML)": 1.00,
    "412 - oleo de soja (ML)": 1.00,
    "415 - leite de coco (ML)": 1.00,
    "416 - leite de condensado (ML)": 1.00,
    "417 - arroz parboilizado (KG)": 1.00,
    "418 - arroz branco (KG)": 1.00,
    "419 - arroz arboreo (KG)": 1.00,
    "420 - massa espaguete (KG)": 1.00,
    "421 - massa pene (KG)": 1.00,
    "422 - massa linguine (KG)": 1.00,
    "423 - massa nhoque (KG)": 1.00,
    "424 - massa pastel  (KG)": 1.00,
    "425 - massa ravioli (KG)": 1.00,
    "426 - castanha para (KG)": 1.00,
    "427 - castanha de caju  (KG)": 1.00,
    "428 - mostarda  em graos (KG)": 1.00,
    "429 - nozes  (KG)": 1.00,
    "430 - damasco (KG)": 1.00,
    "431 - fruta mirtilo (KG)": 1.00,
    "432 - fruta amora (KG)": 1.00,
    "434 - fruta framboesa (KG)": 1.00,
    "435 - vinagre maÃ§a (ML)": 1.00,
    "436 - vinagre de alcool branco (ML)": 1.00,
    "437 - catchup (KG)": 1.00,
    "438 - maionese (KG)": 1.00,
    "439 - molho ingles (KG)": 1.00,
    "440 - mel com favo (KG)": 1.00,
    "441 - alcaparras (KG)": 1.00,
    "442 - farinha de trigo  (KG)": 1.00,
    "444 - farinha de panko (KG)": 1.00,
    "445 - farinha de mandioca (KG)": 1.00,
    "446 - vinho tinto garrafao (ML)": 1.00,
    "447 - vinho branco garrafao (ML)": 1.00,
    "448 - garrafa conhaque (ML)": 1.00,
    "462 - ajinomoto (KG)": 1.00,
    "465 - aÃ§ucar demerara (KG)": 1.00,
    "470 - massa fettutine (KG)": 1.00,
    "475 - vinagre de arroz (ML)": 1.00,
    "491 - amendoas laminadas (KG)": 1.00,
    "497 - fuba de milho (KG)": 1.00,
    "508 - FAROFA (KG)": 1.00,
    "531 - pao de alho (KG)": 1.00,
    "532 - salada pratos (KG)": 1.00,
    "533 - batata soute (KG)": 1.00,
    "587 - chimichurry  (KG)": 1.00,
    "588 - cominho em po (KG)": 1.00,
    "591 - noz moscada (KG)": 1.00,
    "592 - pimenta do reino branca (KG)": 1.00,
    "594 - file de pescada cambucu (KG)": 1.00,
    "596 - mostarda dijon (UN)": 1.00,
    "598 - salsao (UN)": 1.00,
    "600 - batata lavada  (KG)": 1.00,
    "648 - fruta ameixa  (KG)": 1.00,
    "658 - jantar  (UN)": 1.00,
    "663 - polvo (KG)": 1.00,
"672 - alho em po  a granel (KG)": 1.00,
    "673 - cajun picante em po granel (KG)": 1.00,
    "674 - cebola em po a granel (KG)": 1.00,
    "676 - coentro em po a granel  (KG)": 1.00,
    "677 - lemon pepper em po a granel (KG)": 1.00,
    "678 - fumaÃ§a em po a granel  (KG)": 1.00,
    "679 - manjerona em po a granel  (KG)": 1.00,
    "680 - salsa em po a granel  (KG)": 1.00,
    "681 - salvia em po a granel  (KG)": 1.00,
    "685 - lombo suino (KG)": 1.00,
    "689 - file  dourado (KG)": 1.00,
    "698 - catchup  (UN)": 1.00,
    "706 - gema de ovo pasteurizada (UN)": 1.00,
    "717 - file de costela porc ancho (KG)": 1.00,
    "748 - mel  fracionado (cafe) (UN)": 1.00,
    "776 - file mignon suino (KG)": 1.00,
    "782 - castanha do brasil media (KG)": 1.00,
    "785 - massa papardeli (KG)": 1.00,
    "788 - massa caseira (KG)": 1.00,
    "815 - tainha fresca (KG)": 1.00,
    "829 - acen bovino (KG)": 1.00,
    "833 - flor comestivel  (UN)": 1.00,
    "835 - broto alface crespa  (UN)": 1.00,
    "836 - broto alface mimosa (UN)": 1.00,
    "837 - broto alface lisa (UN)": 1.00,
    "838 - broto cenoura (UN)": 1.00,
    "839 - broto agriaÃµ  (UN)": 1.00,
    "840 - broto beterraba (UN)": 1.00,
    "841 - broto coentro (UN)": 1.00,
    "842 - broto mostarda (UN)": 1.00,
    "845 - brocolis comun (UN)": 1.00,
    "847 - broto rabanete (UN)": 1.00,
    "848 - broto rucula  (UN)": 1.00,
    "849 - broto amaranto (UN)": 1.00,
    "852 - arroz integral  (KG)": 1.00,
    "855 - file saithe bacalhau (KG)": 1.00,
    "860 - massa lasanha/canelone (KG)": 1.00,
    "866 - broto repolho (UN)": 1.00,
    "869 - broto couve roxa (UN)": 1.00,
    "896 - broto alface roxa (UN)": 1.00,
    "897 - amaciante de carne  (KG)": 1.00,
    "917 - alho em flocos (KG)": 1.00,
    "921 - mostarda  (UN)": 1.00,
    "937 - pitaia (KG)": 1.00,
    "472 - cafe tradicional (KG)": 1.00,
    "536 - polvilho azedo (KG)": 1.00,
    "550 - manteiga fracionada (sache-cafe) (UN)": 1.00,
    "552 - queijo coalho (KG)": 1.00,
    "560 - adoÃ§ante  (LT)": 1.00,
    "582 - cream cheese fracionado (cafe) (UN)": 1.00,
    "583 - geleias frecionadas (cafe) (UN)": 1.00,
    "589 - gergelim branco  (KG)": 1.00,
    "590 - gergelim preto (KG)": 1.00,
    "605 - fruta abacaxi  (KG)": 1.00,
    "609 - uva rubi (KG)": 1.00,
    "616 - cha camomila (UN)": 1.00,
    "617 - cha hortela (UN)": 1.00,
    "628 - uva passa preta (KG)": 1.00,
    "634 - povilho azedo  (KG)": 1.00,
    "654 - queijo mussarela fatiado (KG)": 1.00,
    "665 - aroma artificial baunilha (ML)": 1.00,
    "666 - chantily 1L (KG)": 1.00,
    "667 - chocolate barra ao leite (KG)": 1.00,
    "668 - chocolate em pÃ³ 50% (KG)": 1.00,
    "669 - chocolate granulado (KG)": 1.00,
    "670 - coco ralado  (KG)": 1.00,
    "671 - doce de leite  (KG)": 1.00,
    "675 - cha erva doce a granel (KG)": 1.00,
    "694 - uva italia (KG)": 1.00,
    "702 - chocolate barra branco  (KG)": 1.00,
    "708 - salsicha congelada (KG)": 1.00,
    "709 - mortadela fatiada (KG)": 1.00,
    "712 - mexedor   para cafe (UN)": 1.00,
    "718 - fruta figo (UN)": 1.00,
    "743 - mini croissant chocolate (KG)": 1.00,
    "744 - mini croissant frango/requeijao (KG)": 1.00,
    "747 - mistura de bolo (UN)": 1.00,
    "751 - mini croissant s/recheio (KG)": 1.00,
    "753 - chia semente (UN)": 1.00,
    "760 - mini croissant  goiabada (KG)": 1.00,
    "761 - mini couvert (KG)": 1.00,
    "768 - cha cidreira (UN)": 1.00,
    "769 - cha frutas vermelhas (UN)": 1.00,
    "770 - mini coxinha de frango (KG)": 1.00,
    "771 - mini bolinha de queijo (KG)": 1.00,
    "819 - aroma baunilha (UN)": 1.00,
    "831 - pao sete graos (UN)": 1.00,
    "916 - nectarina (KG)": 1.00,
    "930 - chocolate sonho de valsa (KG)": 1.00,
    "939 - cha alecrim (UN)": 1.00,
    "276 - queijo mussarela  peÃ§a (KG)": 1.00,
    "515 - molho tomate  (KG)": 1.00,
    "517 - demmi glass (KG)": 1.00,
    "518 - molho bechamel (KG)": 1.00,
    "519 - caldo legumes  (LT)": 1.00,
    "522 - oleo de carvao (LT)": 1.00,
    "528 - burrata (UN)": 1.00,
    "535 - bicarbonato de sodio (KG)": 1.00,
    "537 - coca cola litros (UN)": 1.00,
    "547 - fruta morango natural (KG)": 1.00,
    "548 - molho roti madeira (KG)": 1.00,
    "551 - linguiÃ§a bock  (KG)": 1.00,
    "554 - pao medieval (australiano) (KG)": 1.00,
    "555 - pao mini brioche (KG)": 1.00,
    "556 - peixe tamboriu (KG)": 1.00,
    "557 - mozzarela de bufala (bolinha cerejinha) (KG)": 1.00,
    "562 - coca cola  zero 2 litros (UN)": 1.00,
    "563 - guarana 2 litros (UN)": 1.00,
    "585 - charque (KG)": 1.00,
    "595 - grao de bico (KG)": 1.00,
    "613 - fruta pera (KG)": 1.00,
    "614 - abobora comum (KG)": 1.00,
    "615 - linguiÃ§a blumenau (KG)": 1.00,
    "618 - gergelim em  pasta (UN)": 1.00,
    "626 - kit feijoada (KG)": 1.00,
    "629 - extrato de tomate (UN)": 1.00,
    "630 - molho de  salada lisa (UN)": 1.00,
    "632 - suco de uva  1,5 (UN)": 1.00,
    "633 - suco de laranja  5 litros  (LT)": 1.00,
    "635 - molho tare (LT)": 1.00,
    "638 - aipim ou mandioca (KG)": 1.00,
    "645 - pessego em caldas (UN)": 1.00,
    "646 - sagu (KG)": 1.00,
    "649 - massa conchiglioni (CX)": 1.00,
    "650 - tapioca granulada (KG)": 1.00,
    "653 - CHANPIGNON (KG)": 1.00,
    "659 - arroz de sushi (KG)": 1.00,
    "660 - massa talharin  (KG)": 1.00,
    "684 - mozzarela de bufala  peÃ§a (KG)": 1.00,
    "700 - manguari concentrado (UN)": 1.00,
    "703 - mini risolis de carne (KG)": 1.00,
    "704 - mini salsicha empanada (KG)": 1.00,
    "705 - mini kibe com requeijao (KG)": 1.00,
    "711 - guardanapo embalado (CX)": 1.00,
    "713 - molho tabasco verde (UN)": 1.00,
    "714 - molho tabasco vermelha (UN)": 1.00,
    "716 - amendoin torrado  (UN)": 1.00,
    "719 - sache palito gental (UN)": 1.00,
    "746 - bobina plastica (UN)": 1.00,
    "754 - farinha de arroz (UN)": 1.00,
    "759 - quiabo (KG)": 1.00,
    "762 - espinafre (UN)": 1.00,
    "763 - ervilha (KG)": 1.00,
    "764 - abacaxi desidratado (KG)": 1.00,
    "765 - laranja desidratada (KG)": 1.00,
    "766 - limao desidratado (KG)": 1.00,
    "767 - oregano (KG)": 1.00,
    "856 - agar agar (UN)": 1.00,
    "857 - flocos de arroz (KG)": 1.00,
    "858 - gelatina em po (KG)": 1.00,
    "861 - taÃ§a borone  (UN)": 1.00,
    "862 - pistache granel  (KG)": 1.00,
    "863 - chia granel (KG)": 1.00,
    "883 - file de pescada ( mistura) (KG)": 1.00,
    "900 - copo long drink (UN)": 1.00,
    "902 - copo cerveja (UN)": 1.00,
    "915 - pessego amarelo (UN)": 1.00,
    "918 - molho pimenta vermelha (UN)": 1.00,
    "924 - dianteiro bovino (KG)": 1.00,
    "928 - taca decanter (UN)": 1.00,
    "936 -  polenta pacote (KG)": 1.00,
    "938 - taca vidro (UN)": 1.00,
}

# ğŸ“‹ OpÃ§Ãµes de contagem
opcoes_contagem = {
    "1": "consumo_cafe_da_manha",
    "2": "consumo_casamento_cozinha",
    "3": "consumo_casamento_salao",
    "4": "consumo_pre_wedding",
    "5": "consumo_pos_wedding",
    "6": "contagem_estoque"
}

st.title("ğŸ“¦ Contagem de Itens - Villa Sonali")

# ğŸ“Œ Menu para objetivo
escolha = st.selectbox("Selecione o objetivo da contagem:", list(opcoes_contagem.values()))
objetivo = escolha

# ğŸ“¦ Organiza os itens por categoria
categorias_estoque = {}
for item, categoria in itens_classificados:
    if categoria not in categorias_estoque:
        categorias_estoque[categoria] = []
    categorias_estoque[categoria].append(item)

estoque = {}

st.write("### ğŸ“‹ Insira as quantidades dos itens:")

# Interface de entrada para os itens
for categoria, itens in categorias_estoque.items():
    with st.expander(f"ğŸ“‚ {categoria.title()}"):
        for item in itens:
            quantidade = st.number_input(f"{item}", min_value=0.0, step=0.1, key=item)
            # quantidade = st.number_input(f"{item}", min_value=0.0, step=0.1, key=item)
            valor_unitario = valores_unitarios.get(item, 1.00)
            valor_total = round(quantidade * valor_unitario, 2)

            if quantidade > 0:
                estoque[item] = {
                    "Quantidade": quantidade,
                    "Valor UnitÃ¡rio (R$)": valor_unitario,
                    "Valor Total (R$)": valor_total
                }

# ğŸ“ BotÃ£o para gerar planilha
if st.button("ğŸ“¥ Gerar Planilha e Enviar por Email"):
    if not estoque:
        st.warning("âš ï¸ Nenhum item com quantidade informada.")
    else:
        df = pd.DataFrame.from_dict(estoque, orient="index")
        df.reset_index(inplace=True)
        df.rename(columns={"index": "Item"}, inplace=True)

        data_hora = datetime.now().strftime("%Y-%m-%d_%H-%M-%S")
        nome_arquivo = f"{objetivo}_{data_hora}.xlsx"
        df.to_excel(nome_arquivo, index=False)

        # Envio de e-mail
        try:
            yag = yagmail.SMTP(user="ale.moreira@gmail.com", password="gncuqrzzkstgeamn")
            yag.send(
                to="ale.moreira@gmail.com",
                subject=f"ğŸ“‹ RelatÃ³rio - {objetivo.replace('_', ' ').title()}",
                contents=f"Segue em anexo o controle de estoque referente a: {objetivo.replace('_', ' ').title()}",
                attachments=nome_arquivo
            )
            st.success(f"ğŸ“§ Email enviado com sucesso! Planilha: `{nome_arquivo}`")
        except Exception as e:
            st.error(f"âŒ Erro ao enviar e-mail: {e}")
